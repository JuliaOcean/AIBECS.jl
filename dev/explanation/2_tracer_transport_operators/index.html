<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tracer transport · AIBECS.jl</title><meta name="title" content="Tracer transport · AIBECS.jl"/><meta property="og:title" content="Tracer transport · AIBECS.jl"/><meta property="twitter:title" content="Tracer transport · AIBECS.jl"/><meta name="description" content="Documentation for AIBECS.jl."/><meta property="og:description" content="Documentation for AIBECS.jl."/><meta property="twitter:description" content="Documentation for AIBECS.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="AIBECS.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">AIBECS.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../../tutorials/1_ideal_age/">Ideal age</a></li><li><a class="tocitem" href="../../tutorials/2_radiocarbon/">Radiocarbon</a></li><li><a class="tocitem" href="../../tutorials/3_Pmodel/">A coupled PO₄–POP model</a></li><li><a class="tocitem" href="../../tutorials/4_dustmodel/">A dust model</a></li><li><a class="tocitem" href="../../tutorials/5_river_discharge/">River discharge</a></li><li><a class="tocitem" href="../../tutorials/6_groundwater_discharge/">Groundwater discharge</a></li></ul></li><li><span class="tocitem">How-to guides</span><ul><li><a class="tocitem" href="../../howtos/1_parameters/">Parameters guide</a></li><li><a class="tocitem" href="../../howtos/2_plot/">Plot basic things</a></li><li><a class="tocitem" href="../../howtos/3_cruiseplot/">Plot transect/cruise data</a></li><li><a class="tocitem" href="../../howtos/4_fluxes/">Estimate fluxes</a></li></ul></li><li><span class="tocitem">Explanation</span><ul><li><a class="tocitem" href="../1_concept/">Concept</a></li><li class="is-active"><a class="tocitem" href>Tracer transport</a><ul class="internal"><li><a class="tocitem" href="#Transport-operator"><span>Transport operator</span></a></li><li><a class="tocitem" href="#Discretization"><span>Discretization</span></a></li><li><a class="tocitem" href="#Vectorization"><span>Vectorization</span></a></li><li><a class="tocitem" href="#Ocean-circulations-in-AIBECS"><span>Ocean circulations in AIBECS</span></a></li><li><a class="tocitem" href="#Sinking-particles-in-AIBECS"><span>Sinking particles in AIBECS</span></a></li></ul></li></ul></li><li><span class="tocitem">Reference</span><ul><li><a class="tocitem" href="../../reference/functions/">AIBECS interface (functions and types)</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Explanation</a></li><li class="is-active"><a href>Tracer transport</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tracer transport</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="tracer-transport-operators"><a class="docs-heading-anchor" href="#tracer-transport-operators">Tracer transport</a><a id="tracer-transport-operators-1"></a><a class="docs-heading-anchor-permalink" href="#tracer-transport-operators" title="Permalink"></a></h1><h2 id="Transport-operator"><a class="docs-heading-anchor" href="#Transport-operator">Transport operator</a><a id="Transport-operator-1"></a><a class="docs-heading-anchor-permalink" href="#Transport-operator" title="Permalink"></a></h2><p>To model marine biogeochemical tracers on a global scale we need to be able to account for their movement within the 3D ocean. We do this with tracer <strong>transport operators</strong>, generically denoted by <span>$\mathcal{T}$</span>. These operators <em>act</em> on a tracer field to give its divergence. In other words, take a tracer with concentration <span>$x(\boldsymbol{r})$</span> at location <span>$\boldsymbol{r}$</span> that is transported by some mechanism represented by the operator <span>$\mathcal{T}$</span>. Its divergence at <span>$\boldsymbol{r}$</span> is then <span>$(\mathcal{T} x)(\boldsymbol{r})$</span>.</p><p>In the case of the ocean circulation, i.e., the currents and eddies that transport marine tracers floating around in sea water, the transport operator can be represented by</p><p class="math-container">\[\mathcal{T} = \nabla \cdot \left[ \boldsymbol{u}(\boldsymbol{r}) - \mathbf{K}(\boldsymbol{r}) \nabla \right]\]</p><p>The <span>$\boldsymbol{u}(\boldsymbol{r})$</span> term represents the mean marine current velocity at location <span>$\boldsymbol{r}$</span>. Thus, <span>$\boldsymbol{u}(\boldsymbol{r})$</span> is a 3D vector aligned with the ocean currents and whose amplitude, in m/s, gives the velocity of the moving sea water. The <span>$\mathbf{K}(\boldsymbol{r})$</span> term is a 3×3 matrix that represents eddy diffusivity. That is, it reproduces the effective mixing effect of unresolved eddies, the turbulent vortices that are too small relative to the model grid to be explicitly captured. In earlier models of the ocean circulation, like OCIM&#39;s ancestor (denoted OCIM0 in AIBECS), <span>$\mathbf{K}$</span> was diagonal. Since OCIM1, <span>$\mathbf{K}$</span> contains non-diagonal to orient mixing preferentially along isopycnals.</p><p>In the case of sinking particles, one can assume that they are only transported downwards with some terminal settling velocity <span>$\boldsymbol{w}(\boldsymbol{r}).$</span> The corresponding transport operator is then simply</p><p class="math-container">\[\mathcal{T} = \nabla \cdot \boldsymbol{w}(\boldsymbol{r}).\]</p><h2 id="Discretization"><a class="docs-heading-anchor" href="#Discretization">Discretization</a><a id="Discretization-1"></a><a class="docs-heading-anchor-permalink" href="#Discretization" title="Permalink"></a></h2><p>In order to represent a marine tracer on a computer one needs to <strong>discretize</strong> the 3D ocean into a discrete grid, i.e., a grid with a finite number of boxes. One can go a long way towards understanding what a tracer transport operator is by playing with a simple model with only a few boxes, which is the goal of this piece of documentation.</p><p>The simple box model we consider is embedded in a 2×2×2 &quot;shoebox&quot;. It has 5 <em>wet</em> boxes and 3 <em>dry</em> boxes, as illustrated below:</p><img src="https://user-images.githubusercontent.com/4486578/58314610-3b130b80-7e53-11e9-9fe8-9527cdcca2d0.png" width =800><p>An example of discretized advection, <span>$\boldsymbol{u}$</span>, is shown on the image above, and consists of</p><ul><li>a meridional overturning circulation flowing in a cycle through boxes 1 → 2 → 6 → 5 → 1 (shown in the meridional section 1 panel)</li><li>a zonal current in a reentrant cycling through boxes 1 → 3 → 1 (shown in the layer 1 panel)</li></ul><div class="admonition is-info" id="Note-775a724b8528552e"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-775a724b8528552e" title="Permalink"></a></header><div class="admonition-body"><p>This circulation is available as the <code>Primeau_2x2x2</code> model. You can load it in AIBECS via</p><pre><code class="language-julia hljs">grd, T = Primeau_2x2x2.load()</code></pre><p>Note that this circulation also contains vertical mixing representing deep convection between boxes 2 ↔ 6 (not shown on the image)</p></div></div><h2 id="Vectorization"><a class="docs-heading-anchor" href="#Vectorization">Vectorization</a><a id="Vectorization-1"></a><a class="docs-heading-anchor-permalink" href="#Vectorization" title="Permalink"></a></h2><p>In AIBECS, tracers are represented by column vectors. That is, the 3D tracer field, <span>$x(\boldsymbol{r})$</span>, is <strong>vectorized</strong>, in the sense that the concentrations in each box are rearranged into a column vector.</p><img src="https://user-images.githubusercontent.com/4486578/61757212-fe3ba480-ae02-11e9-8d17-d72866eaafb5.gif" width =800><p>The continuous transport operator <span>$\mathcal{T}$</span> can then be represented by a matrix, denoted by <span>$\mathbf{T}$</span>, and sometimes called the <em>transport matrix</em>. It turns out that in most cases, this matrix is sparse.</p><div class="admonition is-info" id="Note-4f9585ec5351159b"><header class="admonition-header">Note<a class="admonition-anchor" href="#Note-4f9585ec5351159b" title="Permalink"></a></header><div class="admonition-body"><p>A sparse matrix behaves the same way as a regular matrix. The only difference is that in a sparse matrix the majority of the entries are zeros. These zeros are not stored explicitly to save computer memory making it possible to deal with fairly high resolution ocean models.</p></div></div><p>Mathematically, the discretization and vectorization convert an expression with partial derivatives into a matrix vector product. In summary, for the ocean circulation, we do the following conversion</p><p class="math-container">\[(\mathcal{T} x)(\boldsymbol{r}) = \nabla \cdot \left[ \boldsymbol{u}(\boldsymbol{r}) - \mathbf{K}(\boldsymbol{r}) \nabla \right] x(\boldsymbol{r}) \longrightarrow \mathbf{T} \, \boldsymbol{x}\]</p><h2 id="Ocean-circulations-in-AIBECS"><a class="docs-heading-anchor" href="#Ocean-circulations-in-AIBECS">Ocean circulations in AIBECS</a><a id="Ocean-circulations-in-AIBECS-1"></a><a class="docs-heading-anchor-permalink" href="#Ocean-circulations-in-AIBECS" title="Permalink"></a></h2><p>In AIBECS, there are currently a few available circulations that you can directly load with the AIBECS:</p><ul><li><code>Primeau_2x2x2</code>, the circulation described in this documentation page</li><li><code>TwoBoxModel</code>, the 2-box model of the <em>Sarmiento and Gruber</em> (2006) book</li><li><code>Archer_etal_2000</code>, the 3-box model of <em>Archer et al</em>. (2000) (also used in the <em>Sarmiento and Gruber</em> (2006) book)</li><li><code>OCIM0</code>, the unnamed precursor of the OCIM1 (and which should actually be named OCIM0.1)</li><li><code>OCIM1</code></li><li><code>OCIM2</code></li></ul><p>To load any of these, you just need to do</p><pre><code class="language-julia hljs">grd, T = Circulation.load()</code></pre><p>where <code>Circulation</code> is one of the circulations listed above.</p><p>If you are adventurous, you can create your own circulations. AIBECS provides some tools for this. (This is how the <code>Primeau_2x2x2</code> and <code>Archer_etal_2000</code> circulations were created.)</p><h2 id="Sinking-particles-in-AIBECS"><a class="docs-heading-anchor" href="#Sinking-particles-in-AIBECS">Sinking particles in AIBECS</a><a id="Sinking-particles-in-AIBECS-1"></a><a class="docs-heading-anchor-permalink" href="#Sinking-particles-in-AIBECS" title="Permalink"></a></h2><p>There are no loadable transport operators for sinking particles, because there are too many ways to represent sinking particles. However, the AIBECS provides tools to create your own transport operators by providing a scalar or a vector of the downward settling velocities, <code>w</code>. For example, you can create the transport operator for particles sinking at 100 m/d everywhere simply via</p><pre><code class="language-julia hljs">T = transportoperator(grd, w=100u&quot;m/d&quot;)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../1_concept/">« Concept</a><a class="docs-footer-nextpage" href="../../reference/functions/">AIBECS interface (functions and types) »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Tuesday 14 October 2025 23:23">Tuesday 14 October 2025</span>. Using Julia version 1.12.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
